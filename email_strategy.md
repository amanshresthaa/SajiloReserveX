### Email Sending Mechanism

The application uses a robust email sending strategy. When an email needs to be sent, a job is added to a queue using **BullMQ** and **Redis**. A separate worker process listens to this queue, picks up jobs, and sends the emails using **Resend** (as indicated by the `sendEmail` import from `@/libs/resend`). This ensures that email sending does not block the main application flow and can be retried if it fails.

---

### Email Notification Strategy

Here is a breakdown of the emails sent throughout the user journey, based on the code in `server/emails/`, `server/queue/`, and `scripts/queues/`.

| Trigger Event                       | Recipient        | Purpose of Email                                                                                | Technical Details                                                                                                                                   |
| :---------------------------------- | :--------------- | :---------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- |
| **--- Booking Flow ---**            |                  |                                                                                                 |                                                                                                                                                     |
| **Booking Request Received**        | Customer         | To confirm that a booking request is pending and awaiting confirmation from the restaurant.     | **Job Type**: `request_received`<br>**Function**: `sendBookingConfirmationEmail`<br>**Subject**: "Reservation request received – [Restaurant Name]" |
| **Booking Confirmed**               | Customer         | To confirm a booking and provide the final reservation ticket with all details.                 | **Job Type**: `confirmation`<br>**Function**: `sendBookingConfirmationEmail`<br>**Subject**: "Your reservation ticket – [Restaurant Name]"          |
| **Booking Updated by Admin**        | Customer         | To notify the customer that their booking details have been changed by the restaurant.          | **Function**: `sendBookingUpdateEmail`<br>**Subject**: "Reservation updated – [Restaurant Name]"                                                    |
| **Booking Rescheduled (Pending)**   | Customer         | To confirm that a customer's request to reschedule is pending a new table assignment.           | **Function**: `sendBookingModificationPendingEmail`<br>**Subject**: "Reservation modification requested – [Restaurant Name]"                        |
| **Booking Rescheduled (Confirmed)** | Customer         | To confirm that a customer's rescheduling request has been approved and the booking is updated. | **Function**: `sendBookingModificationConfirmedEmail`<br>**Subject**: "Reservation modified – [Restaurant Name]"                                    |
| **Booking Cancelled**               | Customer         | To confirm the cancellation of a reservation.                                                   | **Function**: `sendBookingCancellationEmail`<br>**Subject**: "Booking cancelled – [Restaurant Name]"                                                |
| **--- Reminders ---**               |                  |                                                                                                 |                                                                                                                                                     |
| **24-Hour Reminder**                | Customer         | To remind the customer of their upcoming appointment 24 hours in advance.                       | **Job Type**: `reminder_24h`<br>**Function**: `sendBookingReminderEmail`<br>**Subject**: "[Restaurant Name] on [Date] at [Time]"                    |
| **Short-Time Reminder**             | Customer         | To send a final, short-notice reminder before the appointment (e.g., 1 hour before).            | **Job Type**: `reminder_short`<br>**Function**: `sendBookingReminderEmail`<br>**Subject**: "You're up soon at [Restaurant Name]"                    |
| **--- Post-Booking ---**            |                  |                                                                                                 |                                                                                                                                                     |
| **Feedback/Review Request**         | Customer         | To thank the customer for their visit and ask them to leave a review.                           | **Job Type**: `review_request`<br>**Function**: `sendBookingReviewRequestEmail`<br>**Subject**: "How was your visit at [Restaurant Name]?"          |
| **--- Team Management ---**         |                  |                                                                                                 |                                                                                                                                                     |
| **Team Member Invitation**          | Prospective User | To invite a new user to join a restaurant's team on the platform.                               | **Function**: `sendTeamInviteEmail`<br>**Subject**: "You're invited to join [Restaurant Name] on SajiloReserveX"                                    |
