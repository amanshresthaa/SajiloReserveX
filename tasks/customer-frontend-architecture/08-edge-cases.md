# 8. Edge Cases, Errors, Empty States

| Context                            | Failure Mode / Empty State                     | User-Facing Copy                                                                                                   | Recovery Action                                                                            | Telemetry Event                                              |
| ---------------------------------- | ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ | ------------------------------------------------------------ |
| Global                             | Network offline detected                       | **Banner**: “You’re offline. Showing cached data only.”                                                            | Disable mutations, surface Retry buttons that re-enable when `navigator.onLine === true`.  | `network_offline` (`{ path }`)                               |
| Global                             | 404 route                                      | **Page**: “We couldn’t find that page.” CTA: **Back to home**                                                      | Provide `Home` and `Contact support` links; set `focus()` on heading.                      | `route_not_found` (`{ path }`)                               |
| Global                             | 500/unhandled error                            | **Fallback**: “Something went wrong. Try again or contact support.”                                                | Expose **Try again** button (reload) and log to monitoring.                                | `app_error` (`{ path, message }`)                            |
| Home (`/`)                         | Restaurants fetch fails                        | Toast: “We can’t reach the restaurant list right now. Please retry.”                                               | Show skeleton → error state with **Retry** button (refetch).                               | `restaurants_list_error` (`{ status }`)                      |
| Home (`/`)                         | No restaurants available                       | Empty state card: “No partner restaurants nearby yet. Tell us where to launch next.” CTA: **Request a restaurant** | Link to lead form (`/thank-you`), encourage newsletter signup.                             | `restaurants_empty` (`{ city }`)                             |
| Booking Flow Step 2 (availability) | No slots for selected time/date                | Inline alert: “No tables available at that time. Try another time or party size.”                                  | Surface alternate slots (next 3 times), allow `Modify search`.                             | `availability_empty` (`{ restaurantId, partySize }`)         |
| Booking Submission                 | Create booking mutation fails (4xx validation) | Inline field errors (focus first): “Please double-check your email.”                                               | Keep form values, highlight invalid fields, allow resubmission.                            | `booking_validation_error` (`{ code }`)                      |
| Booking Submission                 | Server error (5xx/timeout)                     | Dialog: “We couldn’t confirm your booking. We’ll keep trying.” CTA: **Retry now**                                  | Retry mutation with exponential backoff; on success show confirmation toast.               | `booking_server_error` (`{ restaurantId }`)                  |
| Dashboard (`/dashboard`)           | No bookings yet                                | Empty state: “You haven’t booked a table yet.” CTA: **Explore restaurants**                                        | Link to `/` filtered by user city; encourage first booking.                                | `dashboard_empty`                                            |
| Dashboard (`/dashboard`)           | Cancel booking mutation fails                  | Toast: “We couldn’t cancel that booking. Please try again.”                                                        | Roll back optimistic update, re-enable **Cancel booking** button.                          | `booking_cancel_error` (`{ bookingId }`)                     |
| Profile (`/profile/manage`)        | Avatar upload fails                            | Inline error below uploader: “Image upload failed. Use JPG or PNG under 5&nbsp;MB.”                                | Keep existing avatar, focus uploader, allow retry.                                         | `profile_upload_error` (`{ fileSize }`)                      |
| Reserve (`/reserve`)               | Connection drops during confirmation           | Sticky banner: “We saved your details. Reconnect to finish confirming your table.”                                 | Persist form state, re-enable **Confirm booking** when back online, auto retry submission. | `network_offline` (`{ path: "/reserve", stage: "confirm" }`) |
| Blog (`/blog`)                     | No articles published                          | Empty list message: “Fresh stories are on the way.” CTA: **Subscribe for updates**                                 | Show newsletter form (Plausible event `blog_subscribe_clicked`).                           | `blog_empty`                                                 |

**Telemetry Policy**: Log events through Plausible `//window.plausible` wrapper with sanitized props (no PII). Correlate high-severity errors (`app_error`, `booking_server_error`) with Sentry alerts.
