
> ship-fast-code@0.1.0 db:run-allocation-test /Users/amankumarshrestha/Downloads/SajiloReserveX
> ./scripts/run-allocation-stress-test.sh


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ALLOCATION ALGORITHM STRESS TEST RUNNER                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Baseline Statistics
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
       ?column?        
-----------------------
 Bookings pending: 115
(1 row)


âš¡ Running Allocation Algorithm
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  Processing: demo-restaurant...
[dotenv@17.2.3] injecting env (37) from .env.local -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.3] injecting env (0) from .env.development -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild

âš¡ ULTRA-FAST AUTO-ASSIGNMENT SCRIPT
ğŸ“ demo-restaurant | 2025-11-06
ğŸš€ Concurrent: 15 | Single attempt only

ğŸ“Š Found 117 bookings (2 pending)

âš¡ Processing 2 bookings...
   15 at a time, no retries

[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:2|category:dining|seating:standard',
  capacity: 2,
  fallback: 0.16,
  tableCount: 5,
  seatSupply: 10
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
[scarcity] using heuristic fallback {
  restaurantId: '8dcb19c3-d767-4993-9b91-4655a4d95921',
  type: 'capacity:4|category:dining|seating:standard',
  capacity: 4,
  fallback: 0.0041,
  tableCount: 11,
  seatSupply: 44
}
âœ… 4d933476 | 17:00:00 | party=6 | status=confirmed â†’ tables=D2-T02,D2-T04 (4589ms)
âœ… 928abbe1 | 19:30:00 | party=6 | status=confirmed â†’ tables=D2-T02,D2-T04 (4597ms)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âš¡ ULTRA-FAST EXECUTION COMPLETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Restaurant: Demo Restaurant
  Date: 2025-11-06
  Total bookings: 117
  Pending processed: 2
  âœ… Success (script reported): 2
  âœ… Success (persisted confirmed): 2
  âŒ Failed: 0
  Success rate (script): 100%
  Success rate (persisted): 100%
  â±ï¸  Total time: 5.66s
  âš¡ Avg per booking: 4593ms
  ğŸ“ Report: /Users/amankumarshrestha/Downloads/SajiloReserveX/reports/auto-assign-ultra-fast-2025-11-06-2025-11-06T08-26-17.376Z.json
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SUCCESSFUL ASSIGNMENTS (2):

  4d933476 | 17:00:00 | party=6 | tables: D2-T02, D2-T04
  928abbe1 | 19:30:00 | party=6 | tables: D2-T02, D2-T04


  âœ… Allocation complete in 7s

ğŸ“Š Post-Allocation Statistics
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      ?column?       
---------------------
 Total bookings: 117
(1 row)

         ?column?          
---------------------------
 Successfully allocated: 2
(1 row)

      ?column?      
--------------------
 Still pending: 115
(1 row)

      ?column?       
---------------------
 Tables used: 2 / 90
(1 row)

          ?column?          
----------------------------
 Multi-table assignments: 2
(1 row)

             ?column?              
-----------------------------------
 Average party size allocated: 6.0
(1 row)


âš¡ Constraint Validation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

> ship-fast-code@0.1.0 db:stress-test /Users/amankumarshrestha/Downloads/SajiloReserveX
> echo 'âš¡ Running allocation stress test...' && source .env.local && psql "$SUPABASE_DB_URL" -v ON_ERROR_STOP=1 -f supabase/seeds/stress-test-allocation.sql && echo 'âœ… Stress test complete!'

âš¡ Running allocation stress test...
BEGIN
SET
SET
DO
COMMIT
âœ… Stress test complete!

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STRESS TEST COMPLETE                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Performance: 7s for all allocations
  See full results above

