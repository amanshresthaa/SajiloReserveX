> pnpm booking:flow --restaurant-slug white-horse-pub-waterbeach --date 2026-04-04 --time 12:00 --party-size 12 --pretty --timeout-ms 180000 --base-url http://localhost:3000

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2026-04-04 --time 12\:00 --party-size 12 --pretty --timeout-ms 180000 --base-url http\://localhost\:3000

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.2] injecting env (0) from .env -- tip: üì° auto-backup env with Radar: https://dotenvx.com/radar
[2025-11-15T00:40:41.690Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":null,"iteration":1,"totalRuns":1,"timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T00:40:41.690Z] [INFO] [submit] Submitting booking request {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-04","time":"12:00","party":12,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T00:40:59.169Z] [INFO] [submit] Booking created {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","duplicate":false,"initialStatus":"pending","durationMs":17476,"maskedEmail":"bo***t@example.com","maskedPhone":"********0123"}
[2025-11-15T00:40:59.787Z] [INFO] [inline_poll] Status update {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","attempt":1,"status":"pending","assignments":0,"elapsedMs":618}
[2025-11-15T00:41:26.014Z] [WARN] [inline_poll] Inline window expired without confirmation {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","state":"timeout","attempts":11}
[2025-11-15T00:41:26.014Z] [INFO] [background_job] Triggering autoAssignAndConfirmIfPossible {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2"}
[auto-assign][job] scheduled {
  bookingId: '62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2',
  reason: 'creation',
  emailVariant: 'standard',
  bypass: true
}
[auto-assign][job] attempt.start {
  bookingId: '62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2',
  attempt: 0,
  maxAttempts: 1
}
[auto-assign][job] attempt.error {
  bookingId: '62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2',
  attempt: 0,
  error: 'Table 17719291-b8fb-440f-88e9-3d33bb3dc900 is not adjacent to the selected set'
}
[auto-assign][job] exhausted {
  bookingId: '62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2',
  attempts: 1,
  maxAttempts: 1
}
[2025-11-15T00:41:40.368Z] [INFO] [background_job] Background auto-assign invoked {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","durationMs":14353}
[2025-11-15T00:41:40.918Z] [INFO] [post_job_poll] Status update {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","attempt":1,"status":"pending","assignments":0,"elapsedMs":550}
[2025-11-15T00:43:58.548Z] [ERROR] [diagnostics] Assignment diagnostics {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","bookingStatus":"pending","assignments":[],"partySize":12,"totalCapacity":0,"seatWaste":0,"lastAutoAssignResult":null,"assignmentStateHistory":[]}
[2025-11-15T00:43:58.549Z] [ERROR] [final_summary] Booking failed to confirm {"correlationId":"486e0766-0f78-4b59-8463-76d031023391","bookingId":"62b7d960-60e0-43f7-bc2d-8d4d5f34a7b2","state":"timeout","durationMs":196438}
‚ùå Booking flow failed; see diagnostics above
‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
