Filling 5 slots on 2025-11-25 (stress-max=4)

>>> [worker 1] Slot 17:30 (party 7)

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 17\:30 --party-size 7 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: üì° version env with Radar: https://dotenvx.com/radar
[dotenv@17.2.2] injecting env (0) from .env -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }
[2025-11-15T10:30:00.853Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"4e77d08f-1e94-4495-bb9e-60f51709ba8c","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:30:00.853Z] [INFO] [submit] Submitting booking request {"correlationId":"4e77d08f-1e94-4495-bb9e-60f51709ba8c","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:30:21.554Z] [INFO] [submit] Booking created {"correlationId":"4e77d08f-1e94-4495-bb9e-60f51709ba8c","bookingId":"621faac3-266d-41bd-aa82-e13e811136ce","duplicate":false,"initialStatus":"confirmed","durationMs":20699,"maskedEmail":"bo***f@example.com","maskedPhone":"********3085"}
[2025-11-15T10:30:22.311Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"4e77d08f-1e94-4495-bb9e-60f51709ba8c","bookingId":"621faac3-266d-41bd-aa82-e13e811136ce","reference":"UPHQY59ZG2","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:30:20.567Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":6043,"attemptId":"e5242ca2-0f8b-4bfb-8255-479915a730da","emailSent":true,"emailVariant":"standard"},"iteration":1,"submitDurationMs":20699,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21458,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["MD-09"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"2b2d0122-390e-4014-87c1-24d8d5775a40","tableId":"404029ec-b768-433a-8574-c9416c926f21","tableNumber":"MD-09","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T10:30:22.312Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"550a4352-7f55-4985-94d1-b047f2279e46","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:30:22.313Z] [INFO] [submit] Submitting booking request {"correlationId":"550a4352-7f55-4985-94d1-b047f2279e46","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:30:42.090Z] [INFO] [submit] Booking created {"correlationId":"550a4352-7f55-4985-94d1-b047f2279e46","bookingId":"17e25873-8c40-40a1-af29-831e7fe179bd","duplicate":false,"initialStatus":"confirmed","durationMs":19776,"maskedEmail":"bo***2@example.com","maskedPhone":"********4352"}
[2025-11-15T10:30:43.128Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"550a4352-7f55-4985-94d1-b047f2279e46","bookingId":"17e25873-8c40-40a1-af29-831e7fe179bd","reference":"6MQLARB4W5","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:30:39.203Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12005,"attemptId":"690f1bf4-9cd2-41b7-9694-fa805da1db25","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":19776,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20816,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["MD-10"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"341d609a-c2f2-4988-b9af-0ea36475f599","tableId":"a1aede9d-2f19-4832-a03d-d004e3aac822","tableNumber":"MD-10","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T10:30:43.130Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"a0b28bed-4f1b-474e-abc3-4254eb73c8b4","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:30:43.130Z] [INFO] [submit] Submitting booking request {"correlationId":"a0b28bed-4f1b-474e-abc3-4254eb73c8b4","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:31:03.052Z] [INFO] [submit] Booking created {"correlationId":"a0b28bed-4f1b-474e-abc3-4254eb73c8b4","bookingId":"1992b79b-5c54-486a-9f68-09bf6b867c6f","duplicate":false,"initialStatus":"confirmed","durationMs":19921,"maskedEmail":"bo***d@example.com","maskedPhone":"********8143"}
[2025-11-15T10:31:03.792Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"a0b28bed-4f1b-474e-abc3-4254eb73c8b4","bookingId":"1992b79b-5c54-486a-9f68-09bf6b867c6f","reference":"9P3QXQB5C2","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:31:00.678Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12005,"attemptId":"0e2c1c2a-6bba-4f3c-9b7d-7ae3775b4481","emailSent":false,"emailVariant":"standard"},"iteration":3,"submitDurationMs":19921,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20662,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["OG-06"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"aef47d01-5a58-4d03-848e-51e5e83f4078","tableId":"1005da9a-3375-4ebb-b85d-69a38c4a391b","tableNumber":"OG-06","zoneId":"3e0273b5-51f8-4571-bcd2-ce3b034a4aaa","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T10:31:03.793Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"dc57fa68-3fc7-435c-982e-d2306231056f","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:31:03.793Z] [INFO] [submit] Submitting booking request {"correlationId":"dc57fa68-3fc7-435c-982e-d2306231056f","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:31:23.290Z] [INFO] [submit] Booking created {"correlationId":"dc57fa68-3fc7-435c-982e-d2306231056f","bookingId":"bae68ea9-3278-439d-b291-506efe1d2f8e","duplicate":false,"initialStatus":"confirmed","durationMs":19497,"maskedEmail":"bo***8@example.com","maskedPhone":"********5068"}
[2025-11-15T10:31:24.026Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"dc57fa68-3fc7-435c-982e-d2306231056f","bookingId":"bae68ea9-3278-439d-b291-506efe1d2f8e","reference":"SARN3L9GDH","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:31:22.449Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5653,"attemptId":"d22a1532-943a-4219-a836-cfa9fa01e2dc","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":19497,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20233,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["PT-07"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"96153469-2350-4d32-9a7f-e2c63bb0e822","tableId":"75e3d6a4-9846-4d96-b24b-37a46527f2a3","tableNumber":"PT-07","zoneId":"a405d9d0-7cd1-447f-a550-b0f0b7d83525","capacity":8,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 20233, max: 21458, avg: 20792.25, p95: 20816 },
  seatWaste: { count: 4, min: 1, max: 1, avg: 1, p95: 1 },
  tablesPerBooking: { count: 4, min: 1, max: 1, avg: 1, p95: 1 },
  uniqueTables: [ 'MD-09', 'MD-10', 'OG-06', 'PT-07' ]
}
‚úÖ Stress run completed 4 booking(s) without failure.

>>> [worker 1] Slot 17:45 (party 8)

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 17\:45 --party-size 8 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }
[2025-11-15T10:31:24.590Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"e29d29e5-959a-4373-a677-677bc57161b9","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:31:24.590Z] [INFO] [submit] Submitting booking request {"correlationId":"e29d29e5-959a-4373-a677-677bc57161b9","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:31:45.102Z] [INFO] [submit] Booking created {"correlationId":"e29d29e5-959a-4373-a677-677bc57161b9","bookingId":"d2487616-9a13-4853-844a-d8d291fc90a1","duplicate":false,"initialStatus":"confirmed","durationMs":20511,"maskedEmail":"bo***5@example.com","maskedPhone":"********2945"}
[2025-11-15T10:31:45.756Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"e29d29e5-959a-4373-a677-677bc57161b9","bookingId":"d2487616-9a13-4853-844a-d8d291fc90a1","reference":"49Q9S2HMQM","bookingDate":"2025-11-25","startTime":"17:45:00","endTime":"19:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:31:42.231Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12005,"attemptId":"47d58a55-7dbd-403e-b56a-5e86352930d5","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":20511,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21167,"tablesAssigned":1,"totalCapacity":8,"seatWaste":0,"tableNumbers":["PT-08"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"01db1e4d-1e46-423c-af81-c4bb130c0b42","tableId":"d91592bf-94f2-4f13-80b2-37137756a62c","tableNumber":"PT-08","zoneId":"a405d9d0-7cd1-447f-a550-b0f0b7d83525","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T10:31:45.757Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"ce8a4714-86b0-4f23-a86d-4170d53020f3","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:31:45.757Z] [INFO] [submit] Submitting booking request {"correlationId":"ce8a4714-86b0-4f23-a86d-4170d53020f3","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:32:06.908Z] [INFO] [submit] Booking created {"correlationId":"ce8a4714-86b0-4f23-a86d-4170d53020f3","bookingId":"dfd4a256-febe-4312-9d55-1c45aff7133a","duplicate":false,"initialStatus":"confirmed","durationMs":21150,"maskedEmail":"bo***4@example.com","maskedPhone":"********4714"}
[2025-11-15T10:32:07.546Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"ce8a4714-86b0-4f23-a86d-4170d53020f3","bookingId":"dfd4a256-febe-4312-9d55-1c45aff7133a","reference":"R99P6Z2332","bookingDate":"2025-11-25","startTime":"17:45:00","endTime":"19:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:32:03.442Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12005,"attemptId":"d386bbf7-c819-41c7-b404-c9706565c4d9","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":21150,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21789,"tablesAssigned":1,"totalCapacity":10,"seatWaste":2,"tableNumbers":["MD-11"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"e46abec5-c123-4908-b9ae-867578c94dd1","tableId":"9b595c3b-f1c3-4069-b18e-8f9e22e3730d","tableNumber":"MD-11","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":10,"startAt":null,"endAt":null}]}
[2025-11-15T10:32:07.547Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"b643554b-b577-4cb2-9858-d1b496b72fd2","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:32:07.547Z] [INFO] [submit] Submitting booking request {"correlationId":"b643554b-b577-4cb2-9858-d1b496b72fd2","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:32:26.867Z] [INFO] [submit] Booking created {"correlationId":"b643554b-b577-4cb2-9858-d1b496b72fd2","bookingId":"aca0708e-c478-4fb0-8fb6-30007100525f","duplicate":false,"initialStatus":"confirmed","durationMs":19320,"maskedEmail":"bo***b@example.com","maskedPhone":"********5541"}
[2025-11-15T10:32:27.505Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"b643554b-b577-4cb2-9858-d1b496b72fd2","bookingId":"aca0708e-c478-4fb0-8fb6-30007100525f","reference":"AWXNTMZXTL","bookingDate":"2025-11-25","startTime":"17:45:00","endTime":"19:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:32:26.053Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5717,"attemptId":"84475e5e-29d3-4d29-b5a2-0f7f61033a1f","emailSent":true,"emailVariant":"standard"},"iteration":3,"submitDurationMs":19320,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19958,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["MD-03","MD-06"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"a3abadb4-a0b1-4f10-8568-2a620e203c48","tableId":"2f14c427-c7fc-47ec-a733-21b3408af503","tableNumber":"MD-03","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":4,"startAt":null,"endAt":null},{"id":"68b2a408-05a0-4fb6-90cf-a590f88ef12e","tableId":"3edec822-a4c8-4b71-ab39-06223c28d739","tableNumber":"MD-06","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:32:27.506Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"3d3b6e7f-9686-4d72-9e86-fa3ea4d1664e","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:32:27.506Z] [INFO] [submit] Submitting booking request {"correlationId":"3d3b6e7f-9686-4d72-9e86-fa3ea4d1664e","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:32:46.956Z] [INFO] [submit] Booking created {"correlationId":"3d3b6e7f-9686-4d72-9e86-fa3ea4d1664e","bookingId":"509b160d-d761-467a-9a62-6742cc4773e5","duplicate":false,"initialStatus":"confirmed","durationMs":19450,"maskedEmail":"bo***f@example.com","maskedPhone":"********6475"}
[2025-11-15T10:32:47.603Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"3d3b6e7f-9686-4d72-9e86-fa3ea4d1664e","bookingId":"509b160d-d761-467a-9a62-6742cc4773e5","reference":"UM88GDMFUT","bookingDate":"2025-11-25","startTime":"17:45:00","endTime":"19:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:32:44.359Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"71dd59a3-efa1-44c6-8032-15c68e514d3b","emailSent":false,"emailVariant":"standard"},"iteration":4,"submitDurationMs":19450,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20097,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["PT-03","PT-04"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"69926e62-cea4-42bb-8824-fd1e2cba60ec","tableId":"33607f27-0151-46fd-995b-7862ca7952e9","tableNumber":"PT-03","zoneId":"a405d9d0-7cd1-447f-a550-b0f0b7d83525","capacity":4,"startAt":null,"endAt":null},{"id":"e9c641ed-bea1-427d-a9fe-5a2a7a1a2dcf","tableId":"e8cfa282-8cb3-4038-bbcb-b1d5390872d8","tableNumber":"PT-04","zoneId":"a405d9d0-7cd1-447f-a550-b0f0b7d83525","capacity":4,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 19958, max: 21789, avg: 20752.75, p95: 21167 },
  seatWaste: { count: 4, min: 0, max: 2, avg: 0.5, p95: 0 },
  tablesPerBooking: { count: 4, min: 1, max: 2, avg: 1.5, p95: 2 },
  uniqueTables: [ 'MD-03', 'MD-06', 'MD-11', 'PT-03', 'PT-04', 'PT-08' ]
}
‚úÖ Stress run completed 4 booking(s) without failure.

>>> [worker 1] Slot 18:00 (party 7)

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 18\:00 --party-size 7 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2025-11-15T10:32:48.141Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"440de317-ff68-4f10-9486-2257ba42d9b5","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:32:48.141Z] [INFO] [submit] Submitting booking request {"correlationId":"440de317-ff68-4f10-9486-2257ba42d9b5","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:33:07.967Z] [INFO] [submit] Booking created {"correlationId":"440de317-ff68-4f10-9486-2257ba42d9b5","bookingId":"f4059600-e62f-451d-895a-c928b9188350","duplicate":false,"initialStatus":"confirmed","durationMs":19824,"maskedEmail":"bo***7@example.com","maskedPhone":"********4317"}
[2025-11-15T10:33:08.690Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"440de317-ff68-4f10-9486-2257ba42d9b5","bookingId":"f4059600-e62f-451d-895a-c928b9188350","reference":"YUWBFEAJ5J","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:33:04.956Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"c3f05e68-e66d-4276-a8fb-9e713e497ce2","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":19824,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20549,"tablesAssigned":1,"totalCapacity":10,"seatWaste":3,"tableNumbers":["MD-12"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"99ced076-3704-442a-9019-04b21d24e2b5","tableId":"6651403a-c674-46c3-a0ec-7e7269416736","tableNumber":"MD-12","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":10,"startAt":null,"endAt":null}]}
[2025-11-15T10:33:08.691Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"1e56169b-3020-4889-8e5a-b4ef98aae063","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:33:08.691Z] [INFO] [submit] Submitting booking request {"correlationId":"1e56169b-3020-4889-8e5a-b4ef98aae063","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:33:29.482Z] [INFO] [submit] Booking created {"correlationId":"1e56169b-3020-4889-8e5a-b4ef98aae063","bookingId":"8521031b-37d6-4688-a644-20e9d3b00fd4","duplicate":false,"initialStatus":"confirmed","durationMs":20789,"maskedEmail":"bo***b@example.com","maskedPhone":"********1691"}
[2025-11-15T10:33:30.172Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"1e56169b-3020-4889-8e5a-b4ef98aae063","bookingId":"8521031b-37d6-4688-a644-20e9d3b00fd4","reference":"PNPADYDYG6","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:33:26.705Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12004,"attemptId":"4bc05e11-9db8-488b-a7f9-011b3bdb336e","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":20789,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21481,"tablesAssigned":1,"totalCapacity":10,"seatWaste":3,"tableNumbers":["PR-05"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"a5c444a0-8ffb-4d97-a0b6-69d7bee84408","tableId":"e50733be-9486-484b-a71b-3f51e0cf05b1","tableNumber":"PR-05","zoneId":"720b2da6-be5b-4d3b-831d-b970fc29d502","capacity":10,"startAt":null,"endAt":null}]}
[2025-11-15T10:33:30.174Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"4c561d2a-29f3-4d7e-89a6-35a693a9f92c","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:33:30.174Z] [INFO] [submit] Submitting booking request {"correlationId":"4c561d2a-29f3-4d7e-89a6-35a693a9f92c","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:33:50.301Z] [INFO] [submit] Booking created {"correlationId":"4c561d2a-29f3-4d7e-89a6-35a693a9f92c","bookingId":"a2f9e1c9-9ece-4cf7-8d32-ffb98b84cdba","duplicate":false,"initialStatus":"confirmed","durationMs":20126,"maskedEmail":"bo***a@example.com","maskedPhone":"********1320"}
[2025-11-15T10:33:50.954Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"4c561d2a-29f3-4d7e-89a6-35a693a9f92c","bookingId":"a2f9e1c9-9ece-4cf7-8d32-ffb98b84cdba","reference":"QLSADX3D4P","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:33:46.998Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"a1607e3f-6af4-40f0-9fc9-7318aa09ff2d","emailSent":false,"emailVariant":"standard"},"iteration":3,"submitDurationMs":20126,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20780,"tablesAssigned":2,"totalCapacity":8,"seatWaste":1,"tableNumbers":["MD-05","MD-04"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"2677caa0-ddfe-4ce1-9ad8-9935960f84d8","tableId":"16a8f6db-c6b3-418d-953a-91f8faad5d9c","tableNumber":"MD-05","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":4,"startAt":null,"endAt":null},{"id":"99894f1f-8cdb-4d93-9f53-ae802f44be5e","tableId":"8f18db09-28e2-49bd-82a6-c3d5118dc709","tableNumber":"MD-04","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:33:50.955Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"798cee89-2c5b-49f9-99ca-3825933f9f67","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:33:50.955Z] [INFO] [submit] Submitting booking request {"correlationId":"798cee89-2c5b-49f9-99ca-3825933f9f67","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:34:10.821Z] [INFO] [submit] Booking created {"correlationId":"798cee89-2c5b-49f9-99ca-3825933f9f67","bookingId":"c753eae5-e479-4cfc-8374-84a7bb60fed1","duplicate":false,"initialStatus":"confirmed","durationMs":19866,"maskedEmail":"bo***9@example.com","maskedPhone":"********4489"}
[2025-11-15T10:34:11.478Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"798cee89-2c5b-49f9-99ca-3825933f9f67","bookingId":"c753eae5-e479-4cfc-8374-84a7bb60fed1","reference":"4KWJJ8KYR9","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:34:09.805Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5676,"attemptId":"9780e917-bc7b-4619-9deb-5484a9f1808a","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":19866,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20523,"tablesAssigned":1,"totalCapacity":10,"seatWaste":3,"tableNumbers":["PR-06"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"0223d1f2-f717-4527-b80f-e73415336bda","tableId":"96039fb5-14ab-40aa-b2c5-a932f7404b0e","tableNumber":"PR-06","zoneId":"720b2da6-be5b-4d3b-831d-b970fc29d502","capacity":10,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 20523, max: 21481, avg: 20833.25, p95: 20780 },
  seatWaste: { count: 4, min: 1, max: 3, avg: 2.5, p95: 3 },
  tablesPerBooking: { count: 4, min: 1, max: 2, avg: 1.25, p95: 1 },
  uniqueTables: [ 'MD-04', 'MD-05', 'MD-12', 'PR-05', 'PR-06' ]
}
‚úÖ Stress run completed 4 booking(s) without failure.

>>> [worker 1] Slot 18:15 (party 2)

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 18\:15 --party-size 2 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.2] injecting env (0) from .env -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
[2025-11-15T10:34:12.031Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"8eb3e11e-6925-4cb4-9646-0de3ea645493","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:34:12.031Z] [INFO] [submit] Submitting booking request {"correlationId":"8eb3e11e-6925-4cb4-9646-0de3ea645493","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:15","party":2,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:34:33.190Z] [INFO] [submit] Booking created {"correlationId":"8eb3e11e-6925-4cb4-9646-0de3ea645493","bookingId":"9640f6ed-1fa9-4729-b733-1c9eade4e83e","duplicate":false,"initialStatus":"confirmed","durationMs":21158,"maskedEmail":"bo***e@example.com","maskedPhone":"********4114"}
[2025-11-15T10:34:33.917Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"8eb3e11e-6925-4cb4-9646-0de3ea645493","bookingId":"9640f6ed-1fa9-4729-b733-1c9eade4e83e","reference":"WQFQMJ3CRA","bookingDate":"2025-11-25","startTime":"18:15:00","endTime":"20:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:34:30.424Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"d6c12895-6ba4-4fb8-b89c-a061ca9e9a75","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":21158,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21885,"tablesAssigned":1,"totalCapacity":2,"seatWaste":0,"tableNumbers":["BA-01"],"partySize":2,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"9130d9a7-2e3f-4e28-aa50-a780d3a9040a","tableId":"b609f914-3ba9-4c8a-8e2f-3eb6611b8c4e","tableNumber":"BA-01","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":2,"startAt":null,"endAt":null}]}
[2025-11-15T10:34:33.918Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"68f3ed12-ad19-4a82-9986-1bf27f324224","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:34:33.918Z] [INFO] [submit] Submitting booking request {"correlationId":"68f3ed12-ad19-4a82-9986-1bf27f324224","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:15","party":2,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:34:53.169Z] [INFO] [submit] Booking created {"correlationId":"68f3ed12-ad19-4a82-9986-1bf27f324224","bookingId":"90fdf10b-4452-4803-8aca-54ebe36d661f","duplicate":false,"initialStatus":"confirmed","durationMs":19250,"maskedEmail":"bo***2@example.com","maskedPhone":"********4312"}
[2025-11-15T10:34:54.126Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"68f3ed12-ad19-4a82-9986-1bf27f324224","bookingId":"90fdf10b-4452-4803-8aca-54ebe36d661f","reference":"UKB4378MHW","bookingDate":"2025-11-25","startTime":"18:15:00","endTime":"20:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:34:52.592Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5440,"attemptId":"7c21438e-0d5a-4d3c-8ba1-67024ea6139e","emailSent":true,"emailVariant":"standard"},"iteration":2,"submitDurationMs":19250,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20208,"tablesAssigned":1,"totalCapacity":2,"seatWaste":0,"tableNumbers":["BA-02"],"partySize":2,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"2f5ea9c3-31cf-45f8-a348-7a45c897cb49","tableId":"6498e7f8-135e-4489-858f-05cdbd2a6a59","tableNumber":"BA-02","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":2,"startAt":null,"endAt":null}]}
[2025-11-15T10:34:54.127Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"08e72d42-7115-4f1b-8aea-da223ae1dbf1","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:34:54.127Z] [INFO] [submit] Submitting booking request {"correlationId":"08e72d42-7115-4f1b-8aea-da223ae1dbf1","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:15","party":2,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:35:13.765Z] [INFO] [submit] Booking created {"correlationId":"08e72d42-7115-4f1b-8aea-da223ae1dbf1","bookingId":"2e4ba06d-5418-4102-b9cc-30d750af58b2","duplicate":false,"initialStatus":"confirmed","durationMs":19637,"maskedEmail":"bo***2@example.com","maskedPhone":"********2342"}
[2025-11-15T10:35:14.372Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"08e72d42-7115-4f1b-8aea-da223ae1dbf1","bookingId":"2e4ba06d-5418-4102-b9cc-30d750af58b2","reference":"W798RRNBV5","bookingDate":"2025-11-25","startTime":"18:15:00","endTime":"20:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:35:11.069Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12006,"attemptId":"5438b7ea-80b8-4e32-8e2b-13c2d4c911a6","emailSent":false,"emailVariant":"standard"},"iteration":3,"submitDurationMs":19637,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20245,"tablesAssigned":1,"totalCapacity":2,"seatWaste":0,"tableNumbers":["MD-01"],"partySize":2,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"f6704152-097d-4f35-8984-1b5ea7dbd93b","tableId":"588e930d-d317-4b0c-9b29-94463e984c2d","tableNumber":"MD-01","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":2,"startAt":null,"endAt":null}]}
[2025-11-15T10:35:14.373Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"30885744-5e2c-43e5-954d-434a6730a579","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:35:14.373Z] [INFO] [submit] Submitting booking request {"correlationId":"30885744-5e2c-43e5-954d-434a6730a579","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:15","party":2,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:35:34.138Z] [INFO] [submit] Booking created {"correlationId":"30885744-5e2c-43e5-954d-434a6730a579","bookingId":"2a13ac9b-f214-4454-86b7-3b135fa0b243","duplicate":false,"initialStatus":"confirmed","durationMs":19765,"maskedEmail":"bo***4@example.com","maskedPhone":"********5744"}
[2025-11-15T10:35:34.788Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"30885744-5e2c-43e5-954d-434a6730a579","bookingId":"2a13ac9b-f214-4454-86b7-3b135fa0b243","reference":"Y4REP3CPKJ","bookingDate":"2025-11-25","startTime":"18:15:00","endTime":"20:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:35:33.275Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5872,"attemptId":"03c89cf5-bcea-4108-afc4-7f21c730e939","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":19765,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20415,"tablesAssigned":1,"totalCapacity":2,"seatWaste":0,"tableNumbers":["MD-02"],"partySize":2,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"ec972ced-3b05-4035-a5ed-3bfbd7e63f8b","tableId":"68454026-63f3-4cd3-94bf-db6fec0fc10f","tableNumber":"MD-02","zoneId":"d4fa3190-cc40-4d4c-9140-5bac194da959","capacity":2,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 20208, max: 21885, avg: 20688.25, p95: 20415 },
  seatWaste: { count: 4, min: 0, max: 0, avg: 0, p95: 0 },
  tablesPerBooking: { count: 4, min: 1, max: 1, avg: 1, p95: 1 },
  uniqueTables: [ 'BA-01', 'BA-02', 'MD-01', 'MD-02' ]
}
‚úÖ Stress run completed 4 booking(s) without failure.

>>> [worker 1] Slot 18:30 (party 3)

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 18\:30 --party-size 3 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: üì° auto-backup env with Radar: https://dotenvx.com/radar
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.2] injecting env (0) from .env -- tip: üì° observe env with Radar: https://dotenvx.com/radar
[2025-11-15T10:35:35.333Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"052f9d32-9a5b-4122-b9d8-eb452dbcc12f","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:35:35.333Z] [INFO] [submit] Submitting booking request {"correlationId":"052f9d32-9a5b-4122-b9d8-eb452dbcc12f","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:30","party":3,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:35:55.883Z] [INFO] [submit] Booking created {"correlationId":"052f9d32-9a5b-4122-b9d8-eb452dbcc12f","bookingId":"e380c94d-4eb7-4577-ad2c-8bee6b811d81","duplicate":false,"initialStatus":"confirmed","durationMs":20549,"maskedEmail":"bo***2@example.com","maskedPhone":"********9332"}
[2025-11-15T10:35:56.544Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"052f9d32-9a5b-4122-b9d8-eb452dbcc12f","bookingId":"e380c94d-4eb7-4577-ad2c-8bee6b811d81","reference":"B87GQ3RZZT","bookingDate":"2025-11-25","startTime":"18:30:00","endTime":"20:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:35:52.870Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12001,"attemptId":"2880c515-47c4-40c3-abf4-6f6248a65379","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":20549,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21211,"tablesAssigned":1,"totalCapacity":4,"seatWaste":1,"tableNumbers":["BA-03"],"partySize":3,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"eb85bb2f-c15b-4eb7-b644-dcf94daae70e","tableId":"031b7cec-6496-42ee-aefe-aac4cf185d47","tableNumber":"BA-03","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:35:56.545Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"10b7bbb4-8a30-448f-80cc-a4c27874878d","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:35:56.546Z] [INFO] [submit] Submitting booking request {"correlationId":"10b7bbb4-8a30-448f-80cc-a4c27874878d","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:30","party":3,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:36:15.121Z] [INFO] [submit] Booking created {"correlationId":"10b7bbb4-8a30-448f-80cc-a4c27874878d","bookingId":"b89640b7-c393-4ca6-99e8-29af057eb3db","duplicate":false,"initialStatus":"confirmed","durationMs":18574,"maskedEmail":"bo***4@example.com","maskedPhone":"********1114"}
[2025-11-15T10:36:15.751Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"10b7bbb4-8a30-448f-80cc-a4c27874878d","bookingId":"b89640b7-c393-4ca6-99e8-29af057eb3db","reference":"LYBCHE9PDJ","bookingDate":"2025-11-25","startTime":"18:30:00","endTime":"20:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:36:13.971Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5367,"attemptId":"ea17e503-05ca-45b0-bca8-1ed4877add4f","emailSent":true,"emailVariant":"standard"},"iteration":2,"submitDurationMs":18574,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19206,"tablesAssigned":1,"totalCapacity":4,"seatWaste":1,"tableNumbers":["BA-04"],"partySize":3,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"fb180df7-a28a-4f47-b08e-c98f57072b71","tableId":"133fcbb5-5249-474e-bf6a-c10285866de3","tableNumber":"BA-04","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:36:15.752Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"5d7d0852-3700-4d40-9137-c48b8dc7686f","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:36:15.752Z] [INFO] [submit] Submitting booking request {"correlationId":"5d7d0852-3700-4d40-9137-c48b8dc7686f","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:30","party":3,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:36:34.738Z] [INFO] [submit] Booking created {"correlationId":"5d7d0852-3700-4d40-9137-c48b8dc7686f","bookingId":"5851b9f2-c246-45cb-bc19-ffc4ce98e49d","duplicate":false,"initialStatus":"confirmed","durationMs":18986,"maskedEmail":"bo***2@example.com","maskedPhone":"********0852"}
[2025-11-15T10:36:35.361Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"5d7d0852-3700-4d40-9137-c48b8dc7686f","bookingId":"5851b9f2-c246-45cb-bc19-ffc4ce98e49d","reference":"7PQ7YEH896","bookingDate":"2025-11-25","startTime":"18:30:00","endTime":"20:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:36:34.120Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5412,"attemptId":"811c20f1-8198-4499-9f19-99a6092745b6","emailSent":true,"emailVariant":"standard"},"iteration":3,"submitDurationMs":18986,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19609,"tablesAssigned":1,"totalCapacity":4,"seatWaste":1,"tableNumbers":["BA-05"],"partySize":3,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"a61502dd-77ae-4eba-a52c-c59c9a5027cd","tableId":"1125b671-6a07-42ad-98e7-fcc828e0a17a","tableNumber":"BA-05","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:36:35.362Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"f23f6a5e-d75e-4f64-a657-f5f6c618a796","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:36:35.362Z] [INFO] [submit] Submitting booking request {"correlationId":"f23f6a5e-d75e-4f64-a657-f5f6c618a796","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:30","party":3,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:36:54.037Z] [INFO] [submit] Booking created {"correlationId":"f23f6a5e-d75e-4f64-a657-f5f6c618a796","bookingId":"d6ffbce6-147a-4167-8c5e-d0b3c515fddf","duplicate":false,"initialStatus":"confirmed","durationMs":18674,"maskedEmail":"bo***e@example.com","maskedPhone":"********6054"}
[2025-11-15T10:36:54.840Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"f23f6a5e-d75e-4f64-a657-f5f6c618a796","bookingId":"d6ffbce6-147a-4167-8c5e-d0b3c515fddf","reference":"QQZKKZZKKC","bookingDate":"2025-11-25","startTime":"18:30:00","endTime":"20:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:36:52.994Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5457,"attemptId":"b582f5d6-cf9e-47ce-8862-4e322f574493","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":18674,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19478,"tablesAssigned":1,"totalCapacity":4,"seatWaste":1,"tableNumbers":["BA-06"],"partySize":3,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"90081d51-5a67-4e08-8662-7e4f78321815","tableId":"db26922d-5fbb-4007-a4f2-a6a6c438aa49","tableNumber":"BA-06","zoneId":"597669cb-939e-41e9-9f50-c47a6c7af3fc","capacity":4,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 19206, max: 21211, avg: 19876, p95: 19609 },
  seatWaste: { count: 4, min: 1, max: 1, avg: 1, p95: 1 },
  tablesPerBooking: { count: 4, min: 1, max: 1, avg: 1, p95: 1 },
  uniqueTables: [ 'BA-03', 'BA-04', 'BA-05', 'BA-06' ]
}
‚úÖ Stress run completed 4 booking(s) without failure.
