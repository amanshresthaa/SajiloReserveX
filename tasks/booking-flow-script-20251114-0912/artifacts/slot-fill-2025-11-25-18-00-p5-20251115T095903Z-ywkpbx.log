
> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 18\:00 --party-size 5 --stress --stress-max 6 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: üì° version env with Radar: https://dotenvx.com/radar
[dotenv@17.2.2] injecting env (0) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[2025-11-15T09:59:03.767Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"ea6928bf-f0cb-4877-972a-ea247d2daf4a","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:59:03.768Z] [INFO] [submit] Submitting booking request {"correlationId":"ea6928bf-f0cb-4877-972a-ea247d2daf4a","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T09:59:22.990Z] [INFO] [submit] Booking created {"correlationId":"ea6928bf-f0cb-4877-972a-ea247d2daf4a","bookingId":"75cda169-671c-4fdc-8f71-1c04a6ca60b4","duplicate":false,"initialStatus":"confirmed","durationMs":19221,"maskedEmail":"bo***f@example.com","maskedPhone":"********2815"}
[2025-11-15T09:59:23.632Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"ea6928bf-f0cb-4877-972a-ea247d2daf4a","bookingId":"75cda169-671c-4fdc-8f71-1c04a6ca60b4","reference":"CKPY24QQYU","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:59:22.140Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5467,"attemptId":"80de7cb9-ae15-46da-add5-2e4b9220186e","emailSent":true,"emailVariant":"standard"},"iteration":1,"submitDurationMs":19221,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19865,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["PR-03"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"6fa925b4-201e-4f33-b893-8f0b7d4a3bf4","tableId":"94fbe4ce-551a-4d6a-a236-3146a69412da","tableNumber":"PR-03","zoneId":"49466514-133f-44b4-bf34-7515c6d1d376","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-15T09:59:23.633Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"1cae565c-b3f8-4249-b5f5-c1d3c8a50ead","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:59:23.633Z] [INFO] [submit] Submitting booking request {"correlationId":"1cae565c-b3f8-4249-b5f5-c1d3c8a50ead","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T09:59:42.523Z] [INFO] [submit] Booking created {"correlationId":"1cae565c-b3f8-4249-b5f5-c1d3c8a50ead","bookingId":"1b379a10-239c-43c2-a800-e0f3cc66e49d","duplicate":false,"initialStatus":"confirmed","durationMs":18889,"maskedEmail":"bo***c@example.com","maskedPhone":"********5652"}
[2025-11-15T09:59:43.159Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"1cae565c-b3f8-4249-b5f5-c1d3c8a50ead","bookingId":"1b379a10-239c-43c2-a800-e0f3cc66e49d","reference":"YZH9RZRPND","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:59:41.696Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5466,"attemptId":"abdd62bc-ce5a-4ef0-8ba6-325ea86eb030","emailSent":true,"emailVariant":"standard"},"iteration":2,"submitDurationMs":18889,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19526,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["PR-04"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"501241c3-23ce-4cb6-940b-aff65d995c09","tableId":"093dd2a7-e94e-4114-8283-8a73bd0caf24","tableNumber":"PR-04","zoneId":"49466514-133f-44b4-bf34-7515c6d1d376","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-15T09:59:43.159Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"65d5cbcc-c80e-4c02-82c2-7ececc2b6637","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:59:43.159Z] [INFO] [submit] Submitting booking request {"correlationId":"65d5cbcc-c80e-4c02-82c2-7ececc2b6637","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:00:03.802Z] [INFO] [submit] Booking created {"correlationId":"65d5cbcc-c80e-4c02-82c2-7ececc2b6637","bookingId":"83b652a6-e2df-4ead-898b-c90dc9ab8671","duplicate":false,"initialStatus":"confirmed","durationMs":20643,"maskedEmail":"bo***c@example.com","maskedPhone":"********2122"}
[2025-11-15T10:00:04.767Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"65d5cbcc-c80e-4c02-82c2-7ececc2b6637","bookingId":"83b652a6-e2df-4ead-898b-c90dc9ab8671","reference":"RDLNHU59AP","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:00:00.975Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"18bb586d-82b6-4de2-bde5-ef9adce84708","emailSent":false,"emailVariant":"standard"},"iteration":3,"submitDurationMs":20643,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21608,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["PT-05"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"b5fdaf74-097d-414e-8b4d-e43405342a0b","tableId":"f7683bf9-7857-4c9f-9ac8-ca4dd9cb499c","tableNumber":"PT-05","zoneId":"0c64f5f9-8cee-4c9d-8d34-3083301eb6b2","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-15T10:00:04.767Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"2a7d1f77-ea22-4c83-9888-0a2ebbe4ddc7","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:00:04.767Z] [INFO] [submit] Submitting booking request {"correlationId":"2a7d1f77-ea22-4c83-9888-0a2ebbe4ddc7","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:00:24.994Z] [INFO] [submit] Booking created {"correlationId":"2a7d1f77-ea22-4c83-9888-0a2ebbe4ddc7","bookingId":"22eccb87-2486-4ef9-b09e-dc21f1eb4cd6","duplicate":false,"initialStatus":"confirmed","durationMs":20227,"maskedEmail":"bo***7@example.com","maskedPhone":"********1577"}
[2025-11-15T10:00:25.620Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"2a7d1f77-ea22-4c83-9888-0a2ebbe4ddc7","bookingId":"22eccb87-2486-4ef9-b09e-dc21f1eb4cd6","reference":"8QVA9JVREX","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:00:24.005Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":6341,"attemptId":"c5ad4aa8-c857-4e15-96c9-05d9572d1749","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":20227,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20853,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["PT-06"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"f425bf38-b930-4645-94b3-f4c3958c7c5e","tableId":"54efcef0-cc59-48ad-bc44-e967dade40f3","tableNumber":"PT-06","zoneId":"0c64f5f9-8cee-4c9d-8d34-3083301eb6b2","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-15T10:00:25.620Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":null,"iteration":5,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:00:25.620Z] [INFO] [submit] Submitting booking request {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:00:52.676Z] [INFO] [submit] Booking created {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":"5dcf3302-22d2-44a3-ae10-568dcf37f1d7","duplicate":false,"initialStatus":"pending","durationMs":27056,"maskedEmail":"bo***6@example.com","maskedPhone":"********2156"}
[2025-11-15T10:00:53.760Z] [INFO] [inline_poll] Status update {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":"5dcf3302-22d2-44a3-ae10-568dcf37f1d7","attempt":1,"status":"pending","assignments":0,"elapsedMs":1083}
[2025-11-15T10:01:08.415Z] [INFO] [inline_poll] Status update {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":"5dcf3302-22d2-44a3-ae10-568dcf37f1d7","attempt":7,"status":"confirmed","assignments":1,"elapsedMs":15738}
[2025-11-15T10:01:08.415Z] [INFO] [final_summary] Booking confirmed via inline flow {"correlationId":"483cc1f6-86eb-42b7-9f9a-72431cb646d7","bookingId":"5dcf3302-22d2-44a3-ae10-568dcf37f1d7","reference":"AT2ZPAYE2Q","bookingDate":"2025-11-25","startTime":"18:00:00","endTime":"20:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:00:46.515Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"0c30102e-ba72-45f0-b324-ef1b7f6642cd","emailSent":false,"emailVariant":"standard"},"iteration":5,"submitDurationMs":27056,"inlineAttempts":7,"inlineDurationMs":15738,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":42795,"tablesAssigned":1,"totalCapacity":8,"seatWaste":3,"tableNumbers":["MD-09"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_poll","assignments":[{"id":"d2247d48-5d5e-4962-b623-dca8d29f2e1d","tableId":"6cbd421e-d424-4239-92fc-e3caf8a491ac","tableNumber":"MD-09","zoneId":"f72b1367-3da5-48b2-9469-97885d1fae9e","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T10:01:08.416Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"52465139-2847-42f7-b152-2876d63508a0","bookingId":null,"iteration":6,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:01:08.416Z] [INFO] [submit] Submitting booking request {"correlationId":"52465139-2847-42f7-b152-2876d63508a0","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:00","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
‚ùå Booking request timed out
‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
