> pnpm booking:flow --restaurant-slug white-horse-pub-waterbeach --date 2026-04-04 --time 12:00 --party-size 9 --pretty --timeout-ms 180000 --base-url http://localhost:3000

> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2026-04-04 --time 12\:00 --party-size 9 --pretty --timeout-ms 180000 --base-url http\://localhost\:3000

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ⚙️  load multiple .env files with { path: ['.env.local', '.env'] }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ⚙️  write to custom object with { processEnv: myObject }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ⚙️  write to custom object with { processEnv: myObject }
[2025-11-15T00:39:33.907Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"29360a2b-f7ae-4bf7-803d-bfce740eab12","bookingId":null,"iteration":1,"totalRuns":1,"timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T00:39:33.908Z] [INFO] [submit] Submitting booking request {"correlationId":"29360a2b-f7ae-4bf7-803d-bfce740eab12","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-04","time":"12:00","party":9,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T00:39:53.315Z] [INFO] [submit] Booking created {"correlationId":"29360a2b-f7ae-4bf7-803d-bfce740eab12","bookingId":"bbb00fe7-7dd3-4b4e-8a71-566aec0e44f0","duplicate":false,"initialStatus":"confirmed","durationMs":19403,"maskedEmail":"bo***t@example.com","maskedPhone":"********0123"}
[2025-11-15T00:39:53.934Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"29360a2b-f7ae-4bf7-803d-bfce740eab12","bookingId":"bbb00fe7-7dd3-4b4e-8a71-566aec0e44f0","reference":"32DEQHLQTN","bookingDate":"2026-04-04","startTime":"12:00:00","endTime":"13:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T00:39:52.201Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5535,"attemptId":"8fdb20ef-3607-4952-876b-dc913a784604","emailSent":true,"emailVariant":"standard"},"iteration":1,"submitDurationMs":19403,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20026,"tablesAssigned":2,"totalCapacity":10,"seatWaste":1,"tableNumbers":["D8","D9"],"partySize":9,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"83aa59be-6466-45fb-b359-f900ad87a8e0","tableId":"15f42ef5-29ac-4fb9-a36d-28d68c53b5e4","tableNumber":"D8","zoneId":"ed027aa1-c042-47dd-bcc0-4d1c1c9a7ef3","capacity":4,"startAt":null,"endAt":null},{"id":"2acb191f-fd66-47fd-85bf-1bcac38f6b0c","tableId":"9f059710-dfd1-44a2-9caf-0bce81d2f1f2","tableNumber":"D9","zoneId":"ed027aa1-c042-47dd-bcc0-4d1c1c9a7ef3","capacity":6,"startAt":null,"endAt":null}]}
✅ Successfully confirmed 1 booking.
__EXIT_CODE=0
