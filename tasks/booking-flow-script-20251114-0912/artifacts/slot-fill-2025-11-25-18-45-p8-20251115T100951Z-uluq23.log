
> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 18\:45 --party-size 8 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ‚öôÔ∏è  specify custom .env file path with { path: '/custom/path/.env' }
[2025-11-15T10:09:51.666Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"e35280c3-0404-4752-9ed8-affe61986cef","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:09:51.667Z] [INFO] [submit] Submitting booking request {"correlationId":"e35280c3-0404-4752-9ed8-affe61986cef","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T10:10:11.736Z] [INFO] [submit] Booking created {"correlationId":"e35280c3-0404-4752-9ed8-affe61986cef","bookingId":"e2884ca0-818c-4301-858e-172b43976394","duplicate":false,"initialStatus":"confirmed","durationMs":20067,"maskedEmail":"bo***3@example.com","maskedPhone":"********8023"}
[2025-11-15T10:10:12.645Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"e35280c3-0404-4752-9ed8-affe61986cef","bookingId":"e2884ca0-818c-4301-858e-172b43976394","reference":"7S8XTKY46Y","bookingDate":"2025-11-25","startTime":"18:45:00","endTime":"20:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:10:09.247Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12003,"attemptId":"2b030363-78a2-4cdd-8ee7-a9e1677451b1","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":20067,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20979,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["MD-03","MD-04"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"5854a117-ead4-4d02-bd1b-129a7447c57c","tableId":"9eea55a7-2f9a-4355-9743-256f0aca5675","tableNumber":"MD-03","zoneId":"74b23058-f095-4eb1-9746-3b23a6b17ee4","capacity":4,"startAt":null,"endAt":null},{"id":"909fa57b-31ad-41f6-9cef-293fe407e433","tableId":"fb0d1196-89e7-4897-85e4-051e1860b93f","tableNumber":"MD-04","zoneId":"74b23058-f095-4eb1-9746-3b23a6b17ee4","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:10:12.646Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"0d5b365b-6905-48fe-8eea-aa684ba25f4c","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:10:12.646Z] [INFO] [submit] Submitting booking request {"correlationId":"0d5b365b-6905-48fe-8eea-aa684ba25f4c","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:10:32.776Z] [INFO] [submit] Booking created {"correlationId":"0d5b365b-6905-48fe-8eea-aa684ba25f4c","bookingId":"eb03d314-ed5e-4b87-b2e0-15762750e52d","duplicate":false,"initialStatus":"confirmed","durationMs":20129,"maskedEmail":"bo***b@example.com","maskedPhone":"********3651"}
[2025-11-15T10:10:33.396Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"0d5b365b-6905-48fe-8eea-aa684ba25f4c","bookingId":"eb03d314-ed5e-4b87-b2e0-15762750e52d","reference":"PJFNFY3R8Y","bookingDate":"2025-11-25","startTime":"18:45:00","endTime":"20:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:10:30.358Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12004,"attemptId":"01fa1c1a-3877-4e26-acbd-4e44d4d9fae8","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":20129,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20749,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["MD-05","MD-06"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"18052870-a439-401a-b52b-47747f5488ea","tableId":"0ec9eb44-1543-46a7-a685-38f608a79d51","tableNumber":"MD-05","zoneId":"74b23058-f095-4eb1-9746-3b23a6b17ee4","capacity":4,"startAt":null,"endAt":null},{"id":"2840bce1-0f14-40b6-84f2-0028b3837ecc","tableId":"f1013bd0-8b23-48a1-8a67-4c5f76545b03","tableNumber":"MD-06","zoneId":"74b23058-f095-4eb1-9746-3b23a6b17ee4","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:10:33.397Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"35b681f9-b92c-4333-9590-1c9174ab45ca","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:10:33.397Z] [INFO] [submit] Submitting booking request {"correlationId":"35b681f9-b92c-4333-9590-1c9174ab45ca","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:10:52.973Z] [INFO] [submit] Booking created {"correlationId":"35b681f9-b92c-4333-9590-1c9174ab45ca","bookingId":"0921e3b3-c309-4165-9a58-93f72373ebd5","duplicate":false,"initialStatus":"confirmed","durationMs":19576,"maskedEmail":"bo***9@example.com","maskedPhone":"********8159"}
[2025-11-15T10:10:53.669Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"35b681f9-b92c-4333-9590-1c9174ab45ca","bookingId":"0921e3b3-c309-4165-9a58-93f72373ebd5","reference":"B8J5WBK5RS","bookingDate":"2025-11-25","startTime":"18:45:00","endTime":"20:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:10:51.975Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5426,"attemptId":"1bc2ba81-0896-44b9-ad72-d53e20dd12c6","emailSent":true,"emailVariant":"standard"},"iteration":3,"submitDurationMs":19576,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20272,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["PT-03","PT-04"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"423059b2-e029-4a20-825c-36952ff9dc3c","tableId":"0e0c1b8b-33c3-4cd5-8f31-5b69350aaa17","tableNumber":"PT-03","zoneId":"bc275831-348d-4c25-9f89-4587d08bf684","capacity":4,"startAt":null,"endAt":null},{"id":"171160c6-2110-492b-930c-419e9b284daa","tableId":"cd9d9929-c851-43ce-b3c2-9c73227902c5","tableNumber":"PT-04","zoneId":"bc275831-348d-4c25-9f89-4587d08bf684","capacity":4,"startAt":null,"endAt":null}]}
[2025-11-15T10:10:53.670Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"18bbc1ee-4c30-4c24-812a-984dd2ec5e46","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T10:10:53.670Z] [INFO] [submit] Submitting booking request {"correlationId":"18bbc1ee-4c30-4c24-812a-984dd2ec5e46","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"18:45","party":8,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T10:11:12.975Z] [INFO] [submit] Booking created {"correlationId":"18bbc1ee-4c30-4c24-812a-984dd2ec5e46","bookingId":"5c24ab39-1dd9-421d-9ab3-675c4e45159b","duplicate":false,"initialStatus":"confirmed","durationMs":19304,"maskedEmail":"bo***e@example.com","maskedPhone":"********2144"}
[2025-11-15T10:11:13.698Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"18bbc1ee-4c30-4c24-812a-984dd2ec5e46","bookingId":"5c24ab39-1dd9-421d-9ab3-675c4e45159b","reference":"ZQ3VNKQ5GD","bookingDate":"2025-11-25","startTime":"18:45:00","endTime":"20:45:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T10:11:10.567Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12004,"attemptId":"938e9c2f-6d02-4cd6-9d01-0205d5c82d33","emailSent":false,"emailVariant":"standard"},"iteration":4,"submitDurationMs":19304,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20028,"tablesAssigned":2,"totalCapacity":8,"seatWaste":0,"tableNumbers":["OG-02","OG-03"],"partySize":8,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"ec3b926c-0230-462e-80e2-95c33d506ab1","tableId":"0de0a824-7231-4a1f-9862-4ae8b04fa98b","tableNumber":"OG-02","zoneId":"a10aa8f6-2298-4141-8ccf-1cf6818f2337","capacity":4,"startAt":null,"endAt":null},{"id":"6fd903eb-f96c-4e19-95eb-7e12b5b2bc8d","tableId":"c118e927-8826-4c78-9eac-7d0597852941","tableNumber":"OG-03","zoneId":"a10aa8f6-2298-4141-8ccf-1cf6818f2337","capacity":4,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 4,
  successes: 4,
  failures: 0,
  maxRuns: 4,
  completedTarget: true,
  durationMs: { count: 4, min: 20028, max: 20979, avg: 20507, p95: 20749 },
  seatWaste: { count: 4, min: 0, max: 0, avg: 0, p95: 0 },
  tablesPerBooking: { count: 4, min: 2, max: 2, avg: 2, p95: 2 },
  uniqueTables: [
    'MD-03', 'MD-04',
    'MD-05', 'MD-06',
    'OG-02', 'OG-03',
    'PT-03', 'PT-04'
  ]
}
‚úÖ Stress run completed 4 booking(s) without failure.
