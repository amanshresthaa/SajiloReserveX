
> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2025-11-25 --time 17\:30 --party-size 7 --stress --stress-max 10 --timeout-ms 180000 --base-url http\://localhost\:3020 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ⚙️  suppress all logs with { quiet: true }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ⚙️  specify custom .env file path with { path: '/custom/path/.env' }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ⚙️  write to custom object with { processEnv: myObject }
[2025-11-15T09:23:42.361Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"4b4f0c56-c61a-4fd3-b893-277fc7290cec","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:23:42.361Z] [INFO] [submit] Submitting booking request {"correlationId":"4b4f0c56-c61a-4fd3-b893-277fc7290cec","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-15T09:24:05.062Z] [INFO] [submit] Booking created {"correlationId":"4b4f0c56-c61a-4fd3-b893-277fc7290cec","bookingId":"3813b7ce-cd44-4c3b-a4fa-04e2a47d7910","duplicate":false,"initialStatus":"confirmed","durationMs":22700,"maskedEmail":"bo***6@example.com","maskedPhone":"********0256"}
[2025-11-15T09:24:05.821Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"4b4f0c56-c61a-4fd3-b893-277fc7290cec","bookingId":"3813b7ce-cd44-4c3b-a4fa-04e2a47d7910","reference":"SLAABBV9JU","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:24:01.803Z","success":false,"reason":"INLINE_TIMEOUT","strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":12006,"attemptId":"a1c4a09b-a7c4-4910-975f-6e191017f67a","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":22700,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":23460,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["MD-09"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"850354a6-5c1a-4e43-9fda-cb9fd4d8d49d","tableId":"a03fdbe3-0de7-4e06-86f1-3a80f9b29851","tableNumber":"MD-09","zoneId":"d8131c66-da4d-43f0-b80f-76d951ec1a72","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T09:24:05.822Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"6403b707-8c55-4607-ad2c-325a02cfbb94","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:24:05.822Z] [INFO] [submit] Submitting booking request {"correlationId":"6403b707-8c55-4607-ad2c-325a02cfbb94","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T09:24:25.876Z] [INFO] [submit] Booking created {"correlationId":"6403b707-8c55-4607-ad2c-325a02cfbb94","bookingId":"39d1a3c4-6843-42f8-a3eb-19288ccf5d3a","duplicate":false,"initialStatus":"confirmed","durationMs":20053,"maskedEmail":"bo***7@example.com","maskedPhone":"********1707"}
[2025-11-15T09:24:26.606Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"6403b707-8c55-4607-ad2c-325a02cfbb94","bookingId":"39d1a3c4-6843-42f8-a3eb-19288ccf5d3a","reference":"LUJJF2FJGW","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:24:24.940Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5504,"attemptId":"440a02ff-bed1-4393-b0d5-da381ffc6072","emailSent":true,"emailVariant":"standard"},"iteration":2,"submitDurationMs":20053,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":20783,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["MD-10"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"920a5d6e-fa48-4f1b-b869-10b308405598","tableId":"d74f60e8-d628-46f4-be29-cbbe26d226a8","tableNumber":"MD-10","zoneId":"d8131c66-da4d-43f0-b80f-76d951ec1a72","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T09:24:26.606Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"486d91cd-181e-4c6c-b476-b9bc725a3707","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:24:26.606Z] [INFO] [submit] Submitting booking request {"correlationId":"486d91cd-181e-4c6c-b476-b9bc725a3707","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T09:24:47.021Z] [INFO] [submit] Booking created {"correlationId":"486d91cd-181e-4c6c-b476-b9bc725a3707","bookingId":"a8662bb8-f4b0-4772-b500-386ecab92899","duplicate":false,"initialStatus":"confirmed","durationMs":20414,"maskedEmail":"bo***d@example.com","maskedPhone":"********9123"}
[2025-11-15T09:24:47.624Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"486d91cd-181e-4c6c-b476-b9bc725a3707","bookingId":"a8662bb8-f4b0-4772-b500-386ecab92899","reference":"Q7XWYF6LSC","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:24:46.260Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5465,"attemptId":"6abdac66-3c09-410d-ba0b-85178dc54d71","emailSent":true,"emailVariant":"standard"},"iteration":3,"submitDurationMs":20414,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":21018,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["OG-06"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"48db8bb0-8dc5-43a3-bff1-c6dcab6819b5","tableId":"4e9f3ff6-22b3-44b3-964e-100439ba72cd","tableNumber":"OG-06","zoneId":"ee0af915-7437-4c3a-9ec1-69a346292372","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T09:24:47.624Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"502703c0-9593-4d89-9ddd-3f4b90c64f22","bookingId":null,"iteration":4,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:24:47.624Z] [INFO] [submit] Submitting booking request {"correlationId":"502703c0-9593-4d89-9ddd-3f4b90c64f22","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T09:25:06.540Z] [INFO] [submit] Booking created {"correlationId":"502703c0-9593-4d89-9ddd-3f4b90c64f22","bookingId":"97e47626-bab7-4ace-bc06-5f9c0c563431","duplicate":false,"initialStatus":"confirmed","durationMs":18915,"maskedEmail":"bo***0@example.com","maskedPhone":"********0320"}
[2025-11-15T09:25:07.197Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"502703c0-9593-4d89-9ddd-3f4b90c64f22","bookingId":"97e47626-bab7-4ace-bc06-5f9c0c563431","reference":"9DT76MHRJ6","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:25:05.826Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5719,"attemptId":"ded4fdda-97b6-4d2f-ace9-38098fa202c5","emailSent":true,"emailVariant":"standard"},"iteration":4,"submitDurationMs":18915,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19573,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["PT-07"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"cc3e74dd-72e2-402a-ab4f-a55c17012ba9","tableId":"79ed07e9-69ec-45aa-8cbc-b476608d7753","tableNumber":"PT-07","zoneId":"786b86fa-7d28-4864-8f73-da99fec681c0","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T09:25:07.197Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"753a9ed8-960e-4296-8f2b-7aacbb06006c","bookingId":null,"iteration":5,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:25:07.197Z] [INFO] [submit] Submitting booking request {"correlationId":"753a9ed8-960e-4296-8f2b-7aacbb06006c","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-15T09:25:26.449Z] [INFO] [submit] Booking created {"correlationId":"753a9ed8-960e-4296-8f2b-7aacbb06006c","bookingId":"55b9bb75-f884-405b-b0d9-5382eaf89879","duplicate":false,"initialStatus":"confirmed","durationMs":19252,"maskedEmail":"bo***8@example.com","maskedPhone":"********9438"}
[2025-11-15T09:25:27.062Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"753a9ed8-960e-4296-8f2b-7aacbb06006c","bookingId":"55b9bb75-f884-405b-b0d9-5382eaf89879","reference":"ZH5YHS9F8W","bookingDate":"2025-11-25","startTime":"17:30:00","endTime":"19:30:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-15T09:25:25.482Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":5502,"attemptId":"f6bff4b3-440c-45d3-bdf5-8b6e657cbe00","emailSent":true,"emailVariant":"standard"},"iteration":5,"submitDurationMs":19252,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":19865,"tablesAssigned":1,"totalCapacity":8,"seatWaste":1,"tableNumbers":["PT-08"],"partySize":7,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"1818b6d1-fa0f-4676-9bd5-a296c1ed86b8","tableId":"b376d616-b7f0-42a9-9aaa-6a439f21a511","tableNumber":"PT-08","zoneId":"786b86fa-7d28-4864-8f73-da99fec681c0","capacity":8,"startAt":null,"endAt":null}]}
[2025-11-15T09:25:27.062Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"ae2ff707-1ffa-456b-81eb-2bc34d6b0c9f","bookingId":null,"iteration":6,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-15T09:25:27.062Z] [INFO] [submit] Submitting booking request {"correlationId":"ae2ff707-1ffa-456b-81eb-2bc34d6b0c9f","bookingId":null,"url":"http://localhost:3020/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2025-11-25","time":"17:30","party":7,"bookingType":"dinner","seating":"any","marketingOptIn":false}
