
> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2026-04-06 --time 19\:00 --party-size 6 --stress --stress-max 4 --timeout-ms 180000 --base-url http\://localhost\:3000 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ⚙️  suppress all logs with { quiet: true }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: ⚙️  override existing env vars with { override: true }
[dotenv@17.2.2] injecting env (0) from .env -- tip: ⚙️  write to custom object with { processEnv: myObject }
[2025-11-16T12:22:40.796Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"cb73048f-d0f8-46a8-bb2c-da3ec850ee53","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:22:40.797Z] [INFO] [submit] Submitting booking request {"correlationId":"cb73048f-d0f8-46a8-bb2c-da3ec850ee53","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:00","party":6,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-16T12:22:47.552Z] [INFO] [submit] Booking created {"correlationId":"cb73048f-d0f8-46a8-bb2c-da3ec850ee53","bookingId":"f31f723d-f118-4fcb-b6a6-5737d64529dd","duplicate":false,"initialStatus":"confirmed","durationMs":6753,"maskedEmail":"bo***f@example.com","maskedPhone":"********0485"}
[2025-11-16T12:22:47.800Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"cb73048f-d0f8-46a8-bb2c-da3ec850ee53","bookingId":"f31f723d-f118-4fcb-b6a6-5737d64529dd","reference":"HRNVXA4N56","bookingDate":"2026-04-06","startTime":"19:00:00","endTime":"21:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-16T12:22:47.141Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":2128,"attemptId":"118228cc-43ba-4691-9b2d-3269eefc4b84","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":6753,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":7004,"tablesAssigned":1,"totalCapacity":6,"seatWaste":0,"tableNumbers":["BA-07"],"partySize":6,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"c729a2bc-ffcb-4f9b-b7c4-611adc1487a4","tableId":"15d6a144-c838-440f-9e76-fc415dd1be3f","tableNumber":"BA-07","zoneId":"05e92343-5dfa-446f-b946-eb59dd07b553","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-16T12:22:47.801Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"8fa50eae-a11d-4587-b4f3-5cf8d8e3c055","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:22:47.801Z] [INFO] [submit] Submitting booking request {"correlationId":"8fa50eae-a11d-4587-b4f3-5cf8d8e3c055","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:00","party":6,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-16T12:22:54.414Z] [INFO] [submit] Booking created {"correlationId":"8fa50eae-a11d-4587-b4f3-5cf8d8e3c055","bookingId":"e81714f4-5406-4e3b-a876-e4d17cdf0e31","duplicate":false,"initialStatus":"confirmed","durationMs":6612,"maskedEmail":"bo***e@example.com","maskedPhone":"********0404"}
[2025-11-16T12:22:54.638Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"8fa50eae-a11d-4587-b4f3-5cf8d8e3c055","bookingId":"e81714f4-5406-4e3b-a876-e4d17cdf0e31","reference":"PH9CUVFMPQ","bookingDate":"2026-04-06","startTime":"19:00:00","endTime":"21:00:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-16T12:22:53.929Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":2233,"attemptId":"a7450614-de27-4231-a097-b4c38bc193cd","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":6612,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":6837,"tablesAssigned":1,"totalCapacity":6,"seatWaste":0,"tableNumbers":["OG-05"],"partySize":6,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"8e5d71d2-fe08-4a32-984e-4c37050219e1","tableId":"24d44799-86c7-4b2c-aeec-acbcd36f0e69","tableNumber":"OG-05","zoneId":"78d96564-d655-417c-b003-6290bde72dcd","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-16T12:22:54.638Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"747b13af-7221-4374-9eb4-03ab7dc44e36","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:22:54.638Z] [INFO] [submit] Submitting booking request {"correlationId":"747b13af-7221-4374-9eb4-03ab7dc44e36","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:00","party":6,"bookingType":"dinner","seating":"any","marketingOptIn":false}
