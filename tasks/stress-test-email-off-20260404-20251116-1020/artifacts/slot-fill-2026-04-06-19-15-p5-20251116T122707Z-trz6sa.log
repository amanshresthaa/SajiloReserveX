
> ship-fast-code@0.1.0 booking:flow /Users/amankumarshrestha/Downloads/SajiloReserveX
> tsx -r tsconfig-paths/register scripts/run-booking-flow.ts --restaurant-slug white-horse-pub-waterbeach --date 2026-04-06 --time 19\:15 --party-size 5 --stress --stress-max 3 --timeout-ms 180000 --base-url http\://localhost\:3000 --pretty

[dotenv@17.2.2] injecting env (0) from .env.local -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }
[dotenv@17.2.2] injecting env (0) from .env.development -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
[dotenv@17.2.2] injecting env (0) from .env -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
[2025-11-16T12:27:08.013Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"6c644d05-3e03-483e-82a9-367683fa0240","bookingId":null,"iteration":1,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:27:08.014Z] [INFO] [submit] Submitting booking request {"correlationId":"6c644d05-3e03-483e-82a9-367683fa0240","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:15","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[supabase] strict hold enforcement active
[2025-11-16T12:27:15.936Z] [INFO] [submit] Booking created {"correlationId":"6c644d05-3e03-483e-82a9-367683fa0240","bookingId":"cb76b7e4-58df-4527-974e-ca2efd2d7e3e","duplicate":false,"initialStatus":"confirmed","durationMs":7922,"maskedEmail":"bo***5@example.com","maskedPhone":"********4305"}
[2025-11-16T12:27:16.207Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"6c644d05-3e03-483e-82a9-367683fa0240","bookingId":"cb76b7e4-58df-4527-974e-ca2efd2d7e3e","reference":"CEVFTQVKSW","bookingDate":"2026-04-06","startTime":"19:15:00","endTime":"21:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-16T12:27:15.526Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":2159,"attemptId":"5e1ac93c-35e9-4c69-924e-eaa29cbd1d5c","emailSent":false,"emailVariant":"standard"},"iteration":1,"submitDurationMs":7922,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":8194,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["BA-08"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"0536973a-4242-4e04-8d58-9725183e2b45","tableId":"2dcab6f8-ccbc-4d31-bc47-fb82bcdf3122","tableNumber":"BA-08","zoneId":"05e92343-5dfa-446f-b946-eb59dd07b553","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-16T12:27:16.208Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"0e93eec4-4c8e-47f2-a4d2-51876c5e3f14","bookingId":null,"iteration":2,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:27:16.208Z] [INFO] [submit] Submitting booking request {"correlationId":"0e93eec4-4c8e-47f2-a4d2-51876c5e3f14","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:15","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-16T12:27:23.308Z] [INFO] [submit] Booking created {"correlationId":"0e93eec4-4c8e-47f2-a4d2-51876c5e3f14","bookingId":"a4fecc30-5a2f-41fb-a3f5-cc70891f936d","duplicate":false,"initialStatus":"confirmed","durationMs":7099,"maskedEmail":"bo***4@example.com","maskedPhone":"********4424"}
[2025-11-16T12:27:23.613Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"0e93eec4-4c8e-47f2-a4d2-51876c5e3f14","bookingId":"a4fecc30-5a2f-41fb-a3f5-cc70891f936d","reference":"6U7HMTAF59","bookingDate":"2026-04-06","startTime":"19:15:00","endTime":"21:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-16T12:27:22.797Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":2138,"attemptId":"a54b1b0e-7225-4a0b-8854-9895043beb22","emailSent":false,"emailVariant":"standard"},"iteration":2,"submitDurationMs":7099,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":7405,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["MD-07"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"566db387-ea24-42a2-8270-98876d370f79","tableId":"36a18791-8339-42c5-a43f-996e2560b240","tableNumber":"MD-07","zoneId":"02941be8-0aec-4421-9cd2-9dac380d4b91","capacity":6,"startAt":null,"endAt":null}]}
[2025-11-16T12:27:23.614Z] [INFO] [bootstrap] Starting booking flow {"correlationId":"3950ae57-0464-4760-9c6a-2e95930b6bac","bookingId":null,"iteration":3,"totalRuns":"stress","timeoutMs":180000,"inlineWindowMs":25000,"pollIntervalMs":2000}
[2025-11-16T12:27:23.614Z] [INFO] [submit] Submitting booking request {"correlationId":"3950ae57-0464-4760-9c6a-2e95930b6bac","bookingId":null,"url":"http://localhost:3000/api/bookings","restaurantSlug":"white-horse-pub-waterbeach","restaurantId":null,"date":"2026-04-06","time":"19:15","party":5,"bookingType":"dinner","seating":"any","marketingOptIn":false}
[2025-11-16T12:27:31.197Z] [INFO] [submit] Booking created {"correlationId":"3950ae57-0464-4760-9c6a-2e95930b6bac","bookingId":"ad3dd190-f0ef-44f1-a176-0ae6b0b277d6","duplicate":false,"initialStatus":"confirmed","durationMs":7583,"maskedEmail":"bo***7@example.com","maskedPhone":"********0457"}
[2025-11-16T12:27:31.468Z] [INFO] [final_summary] Booking confirmed inline (API response) {"correlationId":"3950ae57-0464-4760-9c6a-2e95930b6bac","bookingId":"ad3dd190-f0ef-44f1-a176-0ae6b0b277d6","reference":"3KH9MYN8JU","bookingDate":"2026-04-06","startTime":"19:15:00","endTime":"21:15:00","autoAssignLastResult":{"source":"inline","lastAttemptAt":"2025-11-16T12:27:30.657Z","success":true,"reason":null,"strategy":{"maxTables":null,"requireAdjacency":null},"trigger":"inline_creation","alternates":0,"durationMs":2394,"attemptId":"71388c25-e9e8-45dc-a3e5-8ad6a5f87bf4","emailSent":false,"emailVariant":"standard"},"iteration":3,"submitDurationMs":7583,"inlineAttempts":0,"inlineDurationMs":0,"postJobAttempts":0,"postJobDurationMs":0,"backgroundInvoked":false,"backgroundDurationMs":null,"totalDurationMs":7854,"tablesAssigned":1,"totalCapacity":6,"seatWaste":1,"tableNumbers":["MD-08"],"partySize":5,"duplicateRequest":false,"status":"confirmed_inline_api","assignments":[{"id":"b5f1587d-8986-48ae-93ec-25ba78731e34","tableId":"94040fa4-ae8f-44eb-9298-cba491e3d204","tableNumber":"MD-08","zoneId":"02941be8-0aec-4421-9cd2-9dac380d4b91","capacity":6,"startAt":null,"endAt":null}]}
[stress] Summary {
  totalRuns: 3,
  successes: 3,
  failures: 0,
  maxRuns: 3,
  completedTarget: true,
  durationMs: { count: 3, min: 7405, max: 8194, avg: 7817.666666666667, p95: 7854 },
  seatWaste: { count: 3, min: 1, max: 1, avg: 1, p95: 1 },
  tablesPerBooking: { count: 3, min: 1, max: 1, avg: 1, p95: 1 },
  uniqueTables: [ 'BA-08', 'MD-07', 'MD-08' ]
}
‚úÖ Stress run completed 3 booking(s) without failure.
